<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Samvel B. Gasparyan">

  
  
  
    
  
  <meta name="description" content="IntroductionThis is a short reminder of some simple properties of exponential distributions.
The continuous random variable (RV) \(\xi\) has an exponential distribution with the rate \(\lambda&gt;0\) if its CMD (cumulative distribution function) has the following form">

  
  <link rel="alternate" hreflang="en-us" href="https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-134157980-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-134157980-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu37ae94fde7f6135a8e8cfd653ea9ade8_11929814_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu37ae94fde7f6135a8e8cfd653ea9ade8_11929814_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Biostatistician">
  <meta property="og:url" content="https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/">
  <meta property="og:title" content="Exponential Distribution | Biostatistician">
  <meta property="og:description" content="IntroductionThis is a short reminder of some simple properties of exponential distributions.
The continuous random variable (RV) \(\xi\) has an exponential distribution with the rate \(\lambda&gt;0\) if its CMD (cumulative distribution function) has the following form"><meta property="og:image" content="https://gasparyan.co/images/icon_hu37ae94fde7f6135a8e8cfd653ea9ade8_11929814_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="https://gasparyan.co/images/icon_hu37ae94fde7f6135a8e8cfd653ea9ade8_11929814_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-12-20T10:00:00&#43;04:00">
    
    <meta property="article:modified_time" content="2019-12-20T10:00:00&#43;04:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/"
  },
  "headline": "Exponential Distribution",
  
  "datePublished": "2019-12-20T10:00:00+04:00",
  "dateModified": "2019-12-20T10:00:00+04:00",
  
  "author": {
    "@type": "Person",
    "name": "Samvel B. Gasparyan"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Biostatistician",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gasparyan.co/images/icon_hu37ae94fde7f6135a8e8cfd653ea9ade8_11929814_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "Introduction\rThis is a short reminder of some simple properties of exponential distributions.\nThe continuous random variable (RV) \\(\\xi\\) has an exponential distribution with the rate \\(\\lambda\u0026gt;0\\) if its CMD (cumulative distribution function) has the following form"
}
</script>

  

  


  


  





  <title>Exponential Distribution | Biostatistician</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Biostatistician</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Biostatistician</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/talk/"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Exponential Distribution</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Dec 20, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    5 min read
  </span>
  

  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/r/">R</a>, <a href="/category/statisics/">Statisics</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><em>This is a short reminder of some simple properties of exponential distributions.</em></p>
<p>The continuous random variable (RV) <span class="math inline">\(\xi\)</span> has an exponential distribution with the rate <span class="math inline">\(\lambda&gt;0\)</span> if its CMD (cumulative distribution function) has the following form</p>
<p><span class="math display">\[F_\xi(x)=P(\xi&lt;x)=\left\{\begin{matrix}
&amp;1-e^{-\lambda x}, &amp;x\geq 0.\\
&amp;0 &amp;x&lt;0.
\end{matrix}\right.
\]</span>
This entails that an exponential RV is with 1 probability positive and has the PDF (probability density function)
<span class="math display">\[f_\xi(x)=F_\xi&#39;(x)=\left\{\begin{matrix}
&amp;\lambda e^{-\lambda x}, &amp;x&gt;0,\\
&amp;0 &amp;x&lt;0.
\end{matrix}\right.
\]</span>
If <span class="math inline">\(\xi\)</span> has an exponential distribution with the rate <span class="math inline">\(\lambda\)</span> we will denote this by <span class="math inline">\({\mathbb E}(\lambda).\)</span></p>
<p>In <span class="math inline">\(R\)</span> the following functions can be used to, correspondingly, generate numbers from <span class="math inline">\({\mathbb E}(\lambda)\)</span>, calculate values of CDF, calculate values of PDF</p>
<pre class="r"><code>rexp(n=2, rate=1)</code></pre>
<pre><code>## [1] 0.06697548 0.25507292</code></pre>
<pre class="r"><code>pexp(q=1, rate=1)</code></pre>
<pre><code>## [1] 0.6321206</code></pre>
<pre class="r"><code>dexp(x=1, rate=1)</code></pre>
<pre><code>## [1] 0.3678794</code></pre>
<p>The <em>histogram</em> is a non-parametric estimator for the PDF. Hence we can simulate data from an exponential distribution and show that the histogram based on the data fits the PDF. Consider the case of <span class="math inline">\({\mathbb E}(2)\)</span> and simulate a sample of size <span class="math inline">\(n=10000.\)</span></p>
<pre class="r"><code>rm(list=ls())

n &lt;- 10000
lambda &lt;- 2

X &lt;- rexp(n = n, rate = lambda)
int &lt;- seq(0, max(X), max(X)/100)

hist(X, freq = FALSE, nclass = 50, col = &quot;lightblue&quot;, 
     border = &quot;blue&quot;, ylim = c(0, 2), main = &quot;&quot;)
lines(int, dexp(int, rate = lambda), col = &quot;red&quot;, lty = 2, lwd = 2)</code></pre>
<p><img src="/post/exp/2019-12-20-r-rmarkdown_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>This is a very useful technique to check whether the RVs have the given PDF. We will use this technique below.</p>
</div>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>Suppose <span class="math inline">\(\xi\sim {\mathbb E}(\lambda)\)</span> and <span class="math inline">\(\eta\sim {\mathbb E}(\mu)\)</span> are independent. Calculate the PDF of the RV <span class="math inline">\(\zeta=\eta-\xi.\)</span></p>
<p>First consider the case of <span class="math inline">\(z&gt;0.\)</span> Since <span class="math inline">\(\xi\)</span> and <span class="math inline">\(\eta\)</span> are independent, then the joint PDF of these RVs will be the product of individual PDFs, that is <span class="math inline">\(f_{(\eta,\xi)}(x,y)=f_{\xi}(x)f_{\eta}(y).\)</span> Therefore,</p>
<p><span class="math display">\[F_\zeta(z)=P(\eta-\xi&lt;z)=\int_0^{+\infty}\int_0^{+\infty}I_{\{y-x\leq z\}}(x,y)\lambda\mu e^{-\lambda x-\mu y}d x dy.\]</span>
Making the following variable change <span class="math inline">\(u=y-x\)</span> will give
<span class="math display">\[F_\zeta(z)=P(\eta-\xi&lt;z)=\lambda\mu \int_0^{+\infty}e^{-(\lambda + \mu) x}\left(\int_{-x}^{z}e^{-\mu u}d u\right) dx=1-\frac{\lambda}{\lambda+\mu}e^{-\mu z},\ \ z&gt;0.\]</span>
If <span class="math inline">\(z&lt;0\)</span> then
<span class="math display">\[P(\eta-\xi&lt;z)=P(\xi-\eta&gt;-z)=1-P(\xi-\eta&lt;-z)=1-\left(1-\frac{\mu}{\mu+\lambda}e^{\lambda z}\right)=\frac{\mu}{\lambda+\mu}e^{\lambda z},\ \ z&lt;0.\]</span>
Therefore,
<span class="math display">\[F_\zeta(z)=\left\{\begin{matrix}
&amp;1-\frac{\lambda}{\lambda+\mu} e^{-\mu z}, &amp;z\geq 0,\\
&amp;\frac{\mu}{\lambda+\mu} e^{\lambda z} &amp;z&lt;0.
\end{matrix}\right.\]</span>
The PDF will be
<span class="math display">\[f_\zeta(z)=\frac{\lambda\mu}{\lambda+\mu}\left\{\begin{matrix}
&amp;e^{-\mu z}, &amp;z\geq 0,\\
&amp;e^{\lambda z} &amp;z&lt;0.
\end{matrix}\right.\]</span>
This formula can be checked using simulations.</p>
<pre class="r"><code>rm(list=ls())

n &lt;- 20000
m &lt;- 10000
lambda &lt;- 2
mu &lt;- 5


  X &lt;- rexp(n,lambda)
  Y &lt;- rexp(m, mu)
  Z &lt;- Y-X
  
int &lt;- seq(min(Z),max(Z),(max(Z)-min(Z))/100)
dens &lt;- function(z) (lambda*mu)/(lambda+mu)*ifelse(z&gt;=0,exp(-mu*z),exp(lambda*z))
hist(Z, nclass = 100, freq=FALSE,ylim=c(0,1.5),
     xlim = c(min(Z),max(Z)), main=&quot;&quot;, col = &quot;lightblue&quot;, border = &quot;blue&quot;)
lines(int,dens(int), col=&quot;2&quot;)</code></pre>
<p><img src="/post/exp/2019-12-20-r-rmarkdown_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>From the PDF we can calculate also
<span class="math display">\[E(\zeta)=\frac{\lambda-\mu}{\lambda\mu},\ \ P(\eta&gt;\xi)=\frac{\lambda}{\lambda+\mu}.\]</span></p>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>Suppose that <span class="math inline">\(\eta\sim{\mathbb E}(\mu)\)</span> and <span class="math inline">\(\eta&#39;\sim{\mathbb E}(\mu&#39;)\)</span> are independent. Find the distribution of the RVs <span class="math inline">\(\min(\eta,\eta&#39;)\)</span> and <span class="math inline">\(\max(\eta,\eta&#39;).\)</span></p>
<p>For all <span class="math inline">\(z&gt;0\)</span> we have
<span class="math display">\[\begin{align*}
P(\min(\eta,\eta&#39;)&lt;z)=1-P(\min(\eta,\eta&#39;)\geq z)=1-P(\eta\geq z,\eta&#39;\geq z)=1-e^{-(\mu+\mu&#39;) z},\,z&gt;0,
\end{align*}\]</span>
and <span class="math inline">\(P(\min(\eta,\eta&#39;)&lt;z)=0,\ \ z\leq 0.\)</span> Therefore, <span class="math inline">\(\min(\eta,\eta&#39;)\sim{\mathbb E}(\mu+\mu&#39;)\)</span>, that is, the minimum of two exponentially distributed RVs is an exponentially distributed RV as well, with the rate being equal to the sum of the rates of the given two RVs.</p>
<p>On the other hand,
<span class="math display">\[P(\max(\eta, \eta&#39;) &lt; z)= P(\eta &lt; z, \eta&#39; &lt;z)=(1-e^{-\mu z})(1-e^{-\mu&#39; z}),\,z&gt;0.\]</span>
For <span class="math inline">\(\mu=\mu&#39;\)</span> we have</p>
<p><span class="math display">\[P(\max(\eta, \eta&#39;) &lt; z) = (1-e^{-\mu z})^2,\,z&gt;0,\]</span>
with PDF being equal to <span class="math inline">\(f(z)=2\mu(1-e^{-\mu z})e^{-\mu z},\,z&gt;0\)</span> and <span class="math inline">\(f(z)=0,\,z&lt;0.\)</span></p>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>For given three independent RVs such that <span class="math inline">\(\xi\sim{\mathbb E}(\lambda)\)</span> and <span class="math inline">\(\eta,\eta&#39;\sim{\mathbb E}(\mu),\)</span> calculate the following probability
<span class="math inline">\(\theta=P(\xi&lt;\eta,\xi&lt;\eta&#39;).\)</span></p>
<p>We can reformulate this problem as follows
<span class="math display">\[\theta=P(\xi&lt;\eta,\xi&lt;\eta&#39;)=P(\xi&lt;\min(\eta,\eta&#39;))=P(\xi-\min(\eta,\eta&#39;)&lt;0).\]</span>
Hence, denoting by <span class="math inline">\(\zeta=\xi-\min(\eta,\eta&#39;),\)</span> in the first step we can calculate the distribution function of the RV <span class="math inline">\(\zeta.\)</span> We have <span class="math inline">\(\xi\sim{\mathbb E}(\xi)\)</span> and <span class="math inline">\(\min(\eta,\eta&#39;)\sim{\mathbb E}(2\mu)\)</span> (see Example 2), hence, using the Example 1 we obtain</p>
<p><span class="math display">\[F_\zeta(z)=\left\{\begin{matrix}
&amp;1-\frac{2\mu}{\lambda+2\mu} e^{-\lambda z}, &amp;z\geq 0,\\
&amp;\frac{\lambda}{\lambda+2\mu} e^{2\mu z} &amp;z&lt;0.
\end{matrix}\right.\]</span>
For the PDF we have
<span class="math display">\[f_\zeta(z)=\left\{\begin{matrix}
&amp;\frac{2\lambda\mu}{\lambda+2\mu} e^{-\lambda z}, &amp;z&gt; 0,\\
&amp;\frac{2\lambda\mu}{\lambda+2\mu} e^{2\mu z} &amp;z&lt;0.
\end{matrix}\right.\]</span>
We can, again, check this using simulations.</p>
<pre class="r"><code>rm(list=ls())

n &lt;- 200000
m &lt;- 100000
lambda &lt;- 2.5
mu &lt;- 1.3


X1 &lt;- rexp(n,mu)
X2 &lt;- rexp(n,mu)
Y &lt;- rexp(m, lambda)
Z &lt;- Y - ifelse(X1&gt;=X2,X2,X1)
Coeff &lt;- 2*lambda*mu/(lambda+2*mu)

int &lt;- seq(min(Z), max(Z), (max(Z)-min(Z))/100)
dens &lt;- function(z) Coeff*ifelse(z&gt;=0, exp(-lambda*z), exp(2*mu*z))


hist(Z, nclass = 100, freq=FALSE, ylim=c(0,1.5), 
     xlim=c(min(Z), max(Z)), main = &quot;&quot;, border = &quot;blue&quot;, col = &quot;lightblue&quot;)
lines(int,dens(int), col=&quot;2&quot;)</code></pre>
<p><img src="/post/exp/2019-12-20-r-rmarkdown_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Therefore,
<span class="math display">\[\theta=F_\zeta(0)=\frac{\lambda}{\lambda+2\mu}.\]</span></p>
</div>
<div id="example-4" class="section level2">
<h2>Example 4</h2>
<p>For given three independent RVs such that <span class="math inline">\(\xi,\xi&#39;\sim{\mathbb E}(\lambda)\)</span> and <span class="math inline">\(\eta\sim{\mathbb E}(\mu),\)</span> calculate the following probability
<span class="math inline">\(\vartheta=P(\xi&lt;\eta,\xi&#39;&lt;\eta).\)</span></p>
<p>We can reformulate this problem as follows
<span class="math display">\[\vartheta=P(\xi&lt;\eta,\xi&#39;&lt;\eta)=P(\max(\xi,\xi&#39;)&lt;\eta)=P(\eta-\max(\xi,\xi&#39;)&gt;0).\]</span>
Hence, denoting by <span class="math inline">\(\kappa=\eta-\max(\xi,\xi&#39;),\)</span> in the first step we can calculate the distribution function of the RV <span class="math inline">\(\kappa.\)</span></p>
<p><span class="math display">\[\begin{align*}
P(\kappa&lt;z)=\int_0^{+\infty}\int_0^{+\infty}I(y-x\leq z)2\lambda\mu(1-e^{-\lambda x})e^{-\lambda x-\mu y}d x d y.
\end{align*}\]</span>
If <span class="math inline">\(z&gt;0\)</span> then, denoting <span class="math inline">\(y-x=u\)</span> we get <span class="math inline">\(y=u+x,\,u\in[-x,\infty)\ \ d y= d u.\)</span> Therefore,</p>
<p><span class="math display">\[\begin{align*}
P(\kappa&lt;z)&amp;=2\lambda\mu\int_0^{+\infty}(1-e^{-\lambda x})e^{-\lambda x-\mu x}\int_{-x}^{z}e^{-\mu u}d u d x=\\
&amp;=-2\lambda\int_0^{+\infty}(e^{-(\lambda+\mu) x -\mu z}-e^{-(2\lambda+\mu) x -\mu z}-e^{-\lambda x }+e^{-2\lambda x }) d x=\\
&amp;=1-\frac{2\lambda^2}{(\lambda+\mu)(2\lambda+\mu)}e^{-\mu z },\ \ z&gt;0.
\end{align*}\]</span>
For <span class="math inline">\(z&gt;0\)</span> calculate also (using the notation <span class="math inline">\(x-y=u\)</span>, which entails <span class="math inline">\(x=y+u,\,d x=d u,\)</span> where <span class="math inline">\(u\in[-y,+\infty).\)</span>)
<span class="math display">\[\begin{align*}
P(\max(\xi,\xi&#39;)-\eta&lt;z)&amp;=\int_0^{+\infty}\int_0^{+\infty}I(x-y\leq z)2\lambda\mu(1-e^{-\lambda x})e^{-\lambda x-\mu y}d x d y=\\
&amp;=\int_0^{+\infty}\int_{-y}^{z}(e^{-\lambda(y+u)  - \mu y} - e^{-2\lambda(y+u)  -\mu y}d u dy)=\\
&amp;=1+\mu\left[\frac{e^{-2\lambda z}}{2\lambda+\mu}-\frac{2e^{-\lambda z}}{\lambda+\mu}\right],\ \ z\geq 0.
\end{align*}\]</span></p>
<p>Therefore, for <span class="math inline">\(z&gt;0\)</span> we have
<span class="math display">\[\begin{align*}
P(\kappa&lt;-z)&amp;=1-P(\max(\xi,\xi&#39;)-\eta&lt;z)=\\
&amp;=-\mu\left[\frac{e^{-2\lambda z}}{2\lambda+\mu}-\frac{2e^{-\lambda z}}{\lambda+\mu}\right],\ \ z\geq 0
\end{align*}\]</span>
Finally we obtain
<span class="math display">\[F_\kappa(z)=\left\{\begin{matrix}
&amp;1-\frac{2\lambda^2}{(\lambda+\mu)(2\lambda+\mu)} e^{-\mu z}, &amp;z\geq 0,\\
&amp;-\mu\left[\frac{e^{2\lambda z}}{2\lambda+\mu}-\frac{2e^{\lambda z}}{\lambda+\mu}\right] &amp;z&lt;0.
\end{matrix}\right.\]</span>
For the PDF we have
<span class="math display">\[f_\kappa(z)=\left\{\begin{matrix}
&amp;\frac{2\lambda^2\mu}{(\lambda+\mu)(2\lambda+\mu)} e^{-\mu z}, &amp;z&gt; 0,\\
&amp;-2\lambda\mu\left[\frac{e^{2\lambda z}}{2\lambda+\mu}-\frac{e^{\lambda z}}{\lambda+\mu}\right] &amp;z&lt;0.
\end{matrix}\right.\]</span>
To check this formula we can make the following simulations.</p>
<pre class="r"><code>rm(list=ls())

n &lt;- 200000
m &lt;- 100000
lambda &lt;- 2.5
mu &lt;- 5.5


X1 &lt;- rexp(n,lambda)
X2 &lt;- rexp(n,lambda)
Y &lt;- rexp(m, mu)
Z &lt;- Y - ifelse(X1 &gt;= X2, X1, X2)
Coeff &lt;- 2*mu*lambda^2/((lambda+mu)*(2*lambda+mu))
Coeff1 &lt;- -2*lambda*mu/(2*lambda+mu)
Coeff2 &lt;- -2*lambda*mu/(lambda+mu)

int &lt;- seq(min(Z), max(Z), (max(Z)-min(Z))/100)

dens &lt;- function(z) ifelse(z&gt;=0, Coeff*exp(-mu*z),
                           Coeff1*exp(2*lambda*z)-Coeff2*exp(lambda*z))



hist(Z, nclass = 100, freq=FALSE,ylim=c(0, 1.5), xlim=c(min(Z), max(Z)),
     main = &quot;&quot;, col = &quot;lightblue&quot;, border = &quot;blue&quot;)
lines(int,dens(int), col=&quot;2&quot;)</code></pre>
<p><img src="/post/exp/2019-12-20-r-rmarkdown_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Therefore,
<span class="math display">\[\vartheta=P(\xi&lt;\eta, \xi&#39;&lt;\eta)=P(\kappa&gt;0)=\frac{2\lambda^2}{(\lambda+\mu)(2\lambda+\mu)}.\]</span></p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/tag/simulations/">Simulations</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/&amp;text=Exponential%20Distribution" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/&amp;t=Exponential%20Distribution" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Exponential%20Distribution&amp;body=https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/&amp;title=Exponential%20Distribution" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Exponential%20Distribution%20https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://gasparyan.co/post/exp/2019-12-20-r-rmarkdown/&amp;title=Exponential%20Distribution" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://gasparyan.co/"><img class="avatar mr-3 avatar-circle" src="/author/samvel-b.-gasparyan/avatar_hu805be2d0cd11b3293ad906453806c9b9_1001537_270x270_fill_q90_lanczos_center.jpg" alt="Samvel B. Gasparyan"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://gasparyan.co/">Samvel B. Gasparyan</a></h5>
      <h6 class="card-subtitle">Biostatistician</h6>
      <p class="card-text">Biostatistician in cardiovascular trials.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/media/resume20220321.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/samve" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://orcid.org/0000-0002-4797-2208" target="_blank" rel="noopener">
        <i class="ai ai-orcid"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="http://linkedin.com/in/sgasparyan" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/np/2021-12-31-r-rmarkdown/">Neyman-Pearson and some other Uniformly Most Powerful Tests</a></li>
      
      <li><a href="/post/wrci/2020-01-10-r-rmarkdown/">Win Odds Confidence Intervals in R</a></li>
      
      <li><a href="/post/bayes/2020-11-14-r-rmarkdown/">Bayesian Estimation</a></li>
      
      <li><a href="/talk/aua2018/">Dose Response Curves in R</a></li>
      
      <li><a href="/post/regmod/2018-09-13-r-rmarkdown/">Optimality of Estimators in Regular Models</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
  

  <p class="powered-by">
    © 2022 Samvel B. Gasparyan
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.d9d80f811e95b4b4f6df1eaaf297b05f.js"></script>

    






</body>
</html>
